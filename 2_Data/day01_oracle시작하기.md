## day01_oracle_20220804

- 오라클 버전 : 11.2.0.2.0
- mac : 19c
- 20220809 내용추가 : 테이블 복사, 특정 레코드삭제 및 수정

### - sql developer 주석

-   --   : 한줄 주석문
- /* */  : 여러줄 주석

### - 관계형 데이터베이스의 구성 요소
1. 테이블
    - 관계형 데이터 베이스는 기본적으로 데이터를 2차원 형태의 표로 저장하고 관리를 한다.
    - 표 형태의 데이터 저장공간은 테이블(table)이라고 한다.
    - 테이블은 2차원 형태이므로 가로줄과 세로줄로 구성이 되어 있다.
    * 가로줄 : 행(row)
    * 세로줄 : 열(column)
    
2. 행
    - 행은 저장하려는 하나의 개체를 구성하는 값
    - 예를 들어 학생 한 사람에 대한 정보를 저장한것이다.

3. 열
    - 저장하는 데이터를 대표하는 이름과 공통 특성을 정의
    - 열은 저장정보의 종료(자료형)와 자료의 저장 가능한 중복여부를 설정하게 된다.

### - 오라클에서 속성에 들어가는 주요 자료형(Data type)
1. 숫자
    - number(n, n1) : (정수, 실수)
        * n  : 전체 자릿수
        * n1 : 소수점 자릿수
        * n -n1 : 정수 자릿수
    
                예시) number(7,2) 
                      전체 자릿수는 7자리이고, 정수는 5자리, 소수는 2자리

2. 문자열(char, varchar, varchar2) 
    1. char(n) : 고정자료형
        - 문자열 n개가 저장되는 자료형

    2. varchar(n) : 가변자료형 
        - 문자열 n개가 저장되는 자료형 
        * 현재 오라클에서 사용하지 않는 자료형

    3. varchar2(n) : 가변자료형(가장 많이 사용)
        - 문자열 n개가 저장되는 자료형 
        - 한글은 무조건 한 글자당 2바이트씩 사용된다.
        - '' 홑따옴표 사용

3. 날짜 
    - date 
        - 시스템의 현재 날짜 및 시간이 저장
        - 사용시 sysdate사용

### - 무결성(Integrity) 
- 데이터베이스에 저장된 값과 실제 값이 일치하는 정확성을 의미한다.
- 무결성 제약 조건 
    - 데이터베이스에 저장된 데이터의 정확성을 보장하기 위해 <br>
      정확하지 않는 데이터가 데이터 베이스 내에 저장되는 것을 방지

#### - 데이터베이스 내에서 무결성 제약조건의 종류
1. unique 제약조건
    - 중복이 되면 안되는 제약 조건
    - null 값은 허용한다.
    
            예시) 주민등록번호, 학번, 회원id

2. not null 제약조건
    - 공백(null, '')을 허용하지 않는 제약조건
    
3. check 제약조건
    - 열의 저장할 수 있는 값의 범위 또는 패턴을 정의 할때 사용되는 제약조건
    - 특정한 값이 아닌 데이터가 들어오지 못하게 하는 제약 조건
            
            예시) 성별(남자,여자)
    - 테이블 생성 예시
    
            create table check_test(
                gender varchar2(6) constraint gender_ck check(gender in('남자','여자'))
            );
            - 남자, 여자 외 다른 데이터를 해당 테이블에 입력시 에러가 난다.
    
4. primary key 제약조건 (기본키)
    - 테이블에 하나만 존재해야한다.
    - 기본키 제약 조건
    - unique + not null 제약조건이 합쳐져있다.
    - 기본키는 해당 테이블을 대표하는 컬럼으로써의 역할을 수행하며, <br>
      다른 테이블에서 외래키들이 참조할 수 있는 키로써의 자격을 가진다.
    
5. foreign key 제약조건 (외래키)
    - 외래키는 다른 테이블의 기본키 primary key(기본키)를 참조하는 컬럼의 집합이다. 
    - 외래키값은 참조하고 있는 테이블의 기본키에 없는 내용을 참조할 수 없다. 
    - 이를 참조 무결성(referential integrity)이라고 한다.
    
            - 참조키 : 부모테이블의 컬럼을 이야기 한다.
            - 외래키 : 자식테이블의 컬럼을 이야기 한다.
        
    - 자식테이블의 컬럼 값(데이터)이 부모테이블에 없는경우 무결성의 규칙이 깨져버린다.
    - 외래키가 존재하기 위해 우선적으로 부모테이블이 먼저 생성되어야한다.
    - 옵션 
        * on delete cascade  : 부모의 컬럼 데이터를 삭제시 자식의 데이터도 삭제된다. 
        * on delete set null : 부모의 컬럼 데이터를 삭제시 자식의 데이터는 null 값이 된다.

### - 테이블 생성, 수정, 삭제

### 1. 테이블 생성 및 삭제 
#### 1-1 테이블 생성 

- 형식)

        create table 테이블명(
            컬럼명 자료형(크기) {제약조건},   -- 제약조건은 생략 가능, 제약조건 작성시 {} 없이 작성
            컬럼명 자료형(크기) {제약조건},
            ... ,
            컬럼명 자료형(크기) {제약조건} 
        );


#### 1-2. 테이블 삭제
- 형식)

        - 휴지통삭제 
        drop table 테이블 이름;  

        - 완전삭제
        drop table 테이블이름 purge; 

#### 1-3. 테이블복사
- 형식)
 
    create table 복사후 지정할 테이블명
        as
    select 컬럼 , 컬럼 또는 *
      from 복사할 테이블명
      
- [테이블 복사 예시]()      

### 2. 테이블 컬럼 추가 
- 형식)
    
        alter table 테이블 이름 add(추가할 컬럼명, 데이터타입(크기) {제약조건});

### 3. 테이블 컬럼 수정
- 컬럼의 자료형 뿐만 아닌 전체적인 내용 수정 가능하다.
- 형식)
    
        alter tabel 테이블이름 modify(컬럼명 데이터 타입(크기));
    
### 4. 테이블 컬럼명 변경
- 형식)
    
        alter tabel 테이블이름 rename column 기존컬럼명 to 변경할 컬럼명;
    
### 5. 테이블 컬럼 삭제 
- 형식)
    
        alter tabel 테이블이름 drop column 삭제할컬럼명;



### - 테이블에 데이터 추가
#### 1. 형식1 

        insert into 테이블명 values (
                                        컬럼1 데이터,
                                        컬럼2 데이터,
                                        컬럼3 데이터,
                                        ...,
                                        마지막컬럼 데이터
                                    )

#### 2. 형식2 : not null 제약조건인 컬럼에 데이터 입력

        insert into 테이블이름(not null 제약조건 컬럼들 명시) 
                    values(제약조건 컬럼수에 해당하는 정보기재);

### - 테이블 특정 레코드 수정
        
        update 테이블명
           set 컬럼명 = '수정값'
             , 컬럼명 = '수정값'
             , 컬럼명 = '수정값'
         where 기본키컬럼 = 값1;
         
- 예시

        update student
           set major = '경제학과'
             , age = '20'
             , addr = '서울시 중구'
         where hakbun = '2022_002';
         
- student인 테이블의 hakbun이 2022_002번인 학생의 
- major은 경제학과로 변경
- age는 20살로 변경
- addr은 서울시 중구로 변경       

### - 테이블에 데이터 삭제 
 
 1. 컬럼 유지 데이터 전체 삭제 
 
        delete from 테이블명
        
 2. 컬럼값의 특정 값의 모든 열 삭제
 
        delete from 테이블명
              where 기본키 = 40;
              
        -- ** -- 예시 -- ** --
        delete from dept_02 
              where deptno = 40;
              
        dept_02 테이블에서 40번 부서번호를 가지고있는 값 모두 삭제
        만약 부서번호, 이름, 연봉 컬럼이 있다 가정시에 
        40번 부서번호를 가지고 있으면, 이름, 연봉값모두 삭제된다.

- 꼭 where 절에 나오는 컬럼은 기본키(PK)로 작성한다.

### - rollback, commit 
- rollback 
    - 이전상태로 복원
- commit
    - 데이터 베이스에 완전저장

### - 테이블 생성 및 데이터 추가 예시

        학생 테이블 생성
        구성 요소(컬럼 - 속성)
        -> 학번, 이름, 학과, 나이, 연락처, 주소, 등록일(입학일)
  
- 테이블 생성

        create table student(
            hakbun VARCHAR2(20) primary key,
            name  VARCHAR2(20) not null,
            major VARCHAR2(30),
            age NUMBER(3),
            phone VARCHAR2(20) not null,
            regdate date not null  
        ); 

- 컬럼 추가, 수정 및 삭제

        alter table student add(address VARCHAR2(200))          -- 컬럼 추가
        alter table student modify(age varchar2(5))             -- 컬럼 수정(자료형)
        alter table student rename column address to addr;      -- 컬럼명 수정
        alter table student drop column REGDATE;                -- 컬럼 삭제
        alter table student add(regdate date not null);         -- 컬럼 추가
   
- 데이터 입력
    - 형식1

            insert into student values(
                                            '2022_001',         -- 학번
                                            '홍길동',            -- 이름
                                            '경제학과',           -- 학과
                                            '22',               -- 나이
                                            '010-1234-5678',    -- 핸드폰번호    
                                            '서울시 광진구',       -- 주소
                                            sysdate             -- 날짜
            );
  
    - 형식2

            insert into student(hakbun, name, phone, regdate)
                        values('2022_022','김ㅇㅇ','010-0000-0000',sysdate);

### - 키워드
#### - as : 컬럼 이름 변경
- 컬럼 제목(title)을 변경하는 키워드
- 해당 컬럼에 별명, 별칭을 붙여주는것과 같다.
- 사용시에는 컬럼명 바로 뒤에 사용한다.
- 보통 별칭은 "" 안에 작성한다. ("" as 생략가능)

#### - distinct : 중복제거
- 주로 하나의 컬럼에서 중복된 값을 제거하고 보여줄 때 사용된다.
- distinct 키워드는 항상 select 키워드 다음에 기술한다.
- distinct 키워드 뒤에 나오는 컬럼들은 모두 distinct의 영향을 받는다.
- distinct 키워드 뒤에 여러개의 컬럼이 기술 될 경우 해당 컬럼들은 중복이 되지 않게 나타난다.

### - 연산자
#### - 연결연산자 ||
- 컬럼과 컬럼을 연결하는 연산자

### - 함수
#### - nvl() 
- null 값을 가지는 컬럼은 다른컬럼과 연산시 null로 처리된다. 
- nvl()
    - null 값을 특정한 값으로 변경가능
    - 모든 자료형에 적용이 가능하다.
    - nvl() 함수를 사용할 때는 전환되는 값의 자료형을 일치시켜야 한다.
    
    - 형식 

            nvl(null값이 들어가있는 컬럼명, 변경할 값)

#### - nvl2() 
- 자바에서의 3항연산자와 비슷한 함수
- 형식)
    
        nvl2(컬럼명, expr1, expr2)
        컬럼명의 값이 null이 아닌경우 expr1값을 반환, null값인 경우 expr2값을 반환 받는다. 
